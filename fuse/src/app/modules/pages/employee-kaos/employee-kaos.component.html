<div class="flex h-full w-full flex-col p-4 print:hidden">
    <!-- Toolbar -->
    <div
        class="mb-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"
    >
        <div class="flex gap-2">
            <button
                (click)="exportToCSV()"
                class="rounded-lg bg-green-600 px-4 py-2 font-semibold text-white shadow transition hover:bg-green-700"
            >
                Export to Excel
            </button>

            <button
                (click)="getSelectedRows()"
                [disabled]="!isRowSelected"
                class="rounded-lg bg-sky-600 px-4 py-2 font-semibold text-white shadow transition hover:bg-sky-700 disabled:cursor-not-allowed disabled:bg-gray-400 disabled:text-gray-200"
            >
                Print Selected
            </button>

            <!-- <button
                (click)="getSelectedRows()"
                [disabled]="!isRowSelected"
                class="px-4 py-2 font-semibold text-white transition rounded-lg shadow bg-sky-400 hover:bg-sky-500 disabled:cursor-not-allowed disabled:bg-gray-400 disabled:text-gray-200"
            >
                Preview Selected
            </button> -->

            <button
                *ngIf="!isRowSelected"
                (click)="onSelectAllThisPage()"
                class="rounded-lg bg-yellow-600 px-4 py-2 font-semibold text-white shadow transition hover:bg-yellow-700"
            >
                Select This Page
            </button>

            <!-- Tombol Unselect muncul kalau ada row yang dipilih -->
            <button
                *ngIf="isRowSelected"
                (click)="onUnselectAllThisPage()"
                class="rounded-lg bg-red-600 px-4 py-2 font-semibold text-white shadow transition hover:bg-red-700"
            >
                Unselect
            </button>
        </div>

        <!-- Search input -->
        <div>
            <input
                type="text"
                placeholder="Cari data..."
                (input)="onQuickFilterChanged($event)"
                class="w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm focus:ring focus:ring-blue-300 sm:w-64"
            />
        </div>
    </div>

    <!-- Grid -->
    <div class="min-h-[400px] flex-1">
        <ag-grid-angular
            class="ag-theme-alpine h-full w-full"
            [rowData]="rowData"
            [defaultColDef]="defaultColDef"
            [columnDefs]="colDefs"
            [pagination]="true"
            [paginationPageSize]="50"
            [rowHeight]="30"
            [animateRows]="true"
            (gridReady)="onGridReady($event)"
            [loading]="isLoading"
            [enableCellTextSelection]="true"
            [rowSelection]="'multiple'"
            [suppressRowClickSelection]="true"
            [ensureDomOrder]="true"
            (selectionChanged)="onSelectionChanged($event)"
        >
        </ag-grid-angular>
    </div>
</div>

<app-print-label id="print-section" [datas]="this.data"></app-print-label>
